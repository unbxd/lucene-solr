language: java
jdk:
- openjdk8
sudo: required
services:
- docker
cache:
  directories:
  - "$HOME/.m2"
env:
  global:
  - SERVICE_NAME="solr"
  - LATEST_TAG="latest"
  - secure: Fly98l61aXTsRGjhA94rlrOyDlKpP4a9TPYDnKY0CwLe9KmFfWHlpjGcS2r6VSg/vp+9r50CaV/jDWK+7LHsWh5T570hCEdBQt/rJZ4Q79lLM65xh/o/UUFZuWGfzMcKb60n3QQMSPAbxwKI25Nzp+5IhS3Yxpz2a2kVj+1NSCCQqfaHVs5zkx8Xy28Nq0P10mNDXMppwHRXIL1hRo1QJ/u2kp1MFaLnMijb75oZIFX9VSgAl72afBhU5/AAd6Z17M5ah8pVoe67ec7BmG4yl6xjiSqS0mj2U1LzbwNsl5MnjEsiAsRYnLfQo08zLwXUzGY1mpq/cKkE1IUxf06qnwP6/Xaw8d0A0ASLSllH98/SnxzQyIgEZDGVWzbhRLnKOaAALkvQtl8NCClNbD+/Ol5h6i9CIrM9qUwdekVWgOjrALGa/duFKprsePHSCVcNPqW+sSvhwF8AW7ETvHMObJWLwNrVrwSC0uh6ghRVbfHdRrm7g5e1n2U5p1UHmyuHa3CWKDbmEoWB1EUv4tbR+6MEoFme3H6CbaxriA6Nnh4ZoO8pzdLKlQSUWeFcHGenlggFoWoW1LRos3mTSspd0xgtBCcEhodzQSEMp6cZZOiz9Isbu6pf++AqgjSMdteFDaPNNIx5UdPPWS56fCiM43pgYdzzabAwLxCWn7MsEgE=
  - secure: sEKiLpnFyrNP2641h8QFAmqV8SbY5PegbKpt2LHICnD0bOezTWJ2ha3N6r0sAnB5Wc23Yovt9zpwKO3R1sfLsMVT9QL7aa1a2QnNV+HJSidjJe9DWkdtEyluSlv1+hZDEIuXlVrMljums9fQyxPZreV8xdaAD2e9QY3dk9GDepFWs20gjijWw9fY2/zBlgOY3GsVHHgbHetMoRj6hJNENOTSM/HQFYOcgxXU0g3lshqaghGLti5KXwjj2BkNM7Ul+PP3xn8OQuw8OF1ELuHfUxH8ygAZ9OqTT9yjaN7APKOG9EQiqNWhvoSHRIcS70ouo/wB8sl/9VV7fIW0xYVsIZf4E1xJObBiMY7OX+dw5wbFCN+XfYJazV9pd04y32CRZBSyzfETq190ZDPTxj6DaYLxf/1LS2i6XfMQsq4yq7qRxo6xW2ReKkErgqiJ3x/CqoZqrqAnTYLTPz/mgmDAj7F923ieWNuznxSnbhdyezBRRoI5uzwZHldaKd11JlmmZbo4AK4l7HfBqoWISvPtECWeMUc3J4m23fJkhj8jdYKqH4nvdzEXrfdDIKxD3N1fInH0Ow//j2665mfzRZDvnsvGZ4pMBGF3npF7K9GhZeqMyXSBcfGKJydb2bhZh0AAsDZ7hyFxjwFVsD4zSsVUjGMo2R2gvfA09u5FDpNyXgc=
  - secure: QAMZoUqDlXmnDYeAC510h+3pE+3vOrOpjImWGW2JBCkt3J8Mx9yH6iece+u9/EmyKyPOtwTsPi8S5qlSoPaQdzoxAp9S3RXURMCSInlSv4a85nt1dApAPlN6RtgALDcQx9Z84WiCB/FbYbf3LEhilvJrSe+cZwThgYN/+f2i9j1j/Uc5wBGI6SY9ardQsPhiMuMmArSW+t/rKmHHWc3ZtcbVXNQqwhKN0Sxk04I857n8Tfwv8uGZTQi54shE/yBUlu3WL4Hqxk2uDP9bko4QB3yiFX9rRwoEkjKBiYZE+TnE3ishPDrdaFxGKF8CbcMKCSblCcdz58dqBCm1cDeRKZoF5uKYw2ygWpAMfoqW3SoG3vIa18OdJd0ZzkpmPyDdzzyIcKkffAGSgZPOZDkmRAyD4/2PGUCOUXOIzyH2HqzFyOWyXMiHDI34BZMZc+wtUFwAK6+OhJEOWLL6iqXrtze4nYVZ9ozKTkVzDCRSwlkUCXwntTfdE0S/OBKFO6poFKOW/YBKNkHhVKAlcUnzk9WjnM9RHp09i4De3NrCUcOa/72y7e2zZXUz9tcVGOClNUpBT81o/LceY9/aNeDGR113N5GoK8I1POGsacCYA4b3FysnzKQx3dp/LlY5pFUTX8TklG3JW0v2dPn/Pb+fBvl/antMMA3CVDjDlDKAeis=
  - secure: XKag1GJ/ZncVCv0zg/WjXa+qxfKlPFestfWdXJUtR0R7P46G3sY8cM8mWNyGzdji1MTW3U44tzWf6Gz1MP50+1dc9mTAO38CqpeGvyV7ZloKhppwgy4nz3XHp2g9TVDFp15MdFDnOc8ysKr3ODU4ksCA/j0bXqWDdxAKsH+VyDOieoKwoiiYP0ol1PodVBWNYqdsx7UZ2OIIkzAE30AfGoZs3Jq3v3TaoLOLucfg7K8v2iYDea2ef5iog75Lz92AQJw1PM2LR4cRFpEKdnqmGMpwoUAWnipPjivyWcTm5TGT5RYe0mDfLMQwsI7/X8j/Ko/LZ30bReJ8SWI6+IY0bEQQnI6BYFPizk58fEyuIsAcg+Sk3T1Vbr3lU9AnXtgdMlMvK+FC/mxQgIT6Bramd2I8ypkjzk2iaTjbRCFaRT9jpfXxFUIaYcYwzrJuIfnVCxHkB6lIYVQik2oGX8Nfcc+khWqF75fyctGEmOCenVwEX48Y/UjFDEskfdHiKW+e4El6BFfI8J4h2ZqwXg4y1GQP/fb0Vt6gQ4UJWPk8Zg/W5nctRzLoEbXwWEY9GPWorpqMhosp3w/LhrQL3s0SNl/gnlHjNzaFkG1IOvBelsoshXFESRjLGeZXQuGGTnVKtvLQLxjWrL8U+v9LhB9Sv6ZPjixCmCIN1ks93f4zT90=
  - secure: WxU8Sn2gAjqIDyUubrXXx2rJFTAwcfFLz8LTnBMNVXu1JKPQ95i6/Z1pJCu/xyJmpxCqcEJwAtu1jjzh03z0FZAW6VGwzd1o4v3esNF+wHIFpFh92wRGtRxkE86uZWInJhGeVfd9/bCN16qzD76uTJWbmKXkJ8CZ3PDZEralGpbXyE3zb7KGpEecFdpYrHGLdoFboKnTRZiETtyPzhStATqp+atNgpemtKVtSmeArXQLR10o0AupaK5WnCL69p+zi8GzcpN5fwfU6meXcKRmbumY/rrHVASaKil0Aa8CO/ed8KF5X/IA2XirmO1BKm1+lkyxWctgx4CTL2aegyHmR0AtCwXHCRTLevJ48VN9mXUjqiYEBJm1opHQ4lNgc9oz+IkTRycxUTv3waWP4x2tTnOlk/+jDPvjXF7+Au7+Fei7KRPOgQayrfhGv5w2xd900raR5Ck1lfr7mc79yCCIhnNLdNwyii5rP3v66nOFXEnth4mIx3UUoyIljrysjvV9NkoqVJLXGOSr0UEYK5bszgTif7i0IS87dbgBQIWOCxCftUbMSCxX7Z5mMxRWwafr9kOnLmcUCywlVeUwQSPuy7YmlC4Qp8mhXGmbsznTqhHupqGc9wLmN8ECd5t46R8msFEs6GqVkfIylQWNS8O+yaL+7vwLcNjq3ame0Er0WXI=
addons:
  apt:
    packages: ant
before_install:
- ant ivy-bootstrap
- sudo apt-get -qq update
- sudo apt-get install bash
- sudo pip install awscli
- eval $(aws ecr --no-include-email get-login --region us-east-1)
script:
- "./scripts/build.sh"
- cd solr
- docker build --build-arg SOLR_VERSION=${TRAVIS_TAG//v/}-unbxd -t solr:latest .
after_success:
- export PATH=$PATH:$HOME/.local/bin
- which -a aws
- if [ -n "$TRAVIS_TAG" ]; then $TRAVIS_BUILD_DIR/scripts/push_to_aws.sh; fi
- "$TRAVIS_BUILD_DIR/scripts/ci.sh"
notifications:
  slack:
    secure: p8c/3jqhYHnu70UafbtkLJjWxA42mxdYPsHlbzEzGTYt7VpT13AUxv0xEAG5udLc2F5xO25CMUFiE1I31vzDuMYcnHRVt2bF3OMVkGXwgWte9NseZ9ShQfHF9erif2Y4PdgwRziGAtVHoYs8ROecmsgSAs7Divm+YrTiljKg1yreof0SdUo1DUFes5Kkcs5TRnuER0HFpQWt8oYZruuLi+QC4VU3NoaUt61N6uwvcYkmare3FWWJxAUVuCuvgw2Kxl0O0WR6/y0nSgW4Zf1Tv1B9wYSx2l5h04vIdQFkSahljwT+j+sGUjrrDS4Amsteq9E3cyPNHLGDHGPePrbrCNFdsn8Lsmbx1i1/ls81pcdfXD6RTeqey4/9yZeurCNKh9tV5dxo1fupvNpGAhyrQP63i2ZYpFoPkWYgzmgQEOjD3+VLGrIb/AK1tvWgsca4tbz/Het1V0sA+TSc3398pwMxfzv4/xAKrJlLqWgAs1LnGn2qHczk98Wm6+4VjSGjycjiBmlfUHj10SqwnQH2QFCjX09iBXLu3aovnmIu5RlguWTqYEGBGquSBvpRRhG2yoeBpEF3LYB0L6qaNPdpkpfuRAmRVxGrTTEUAi+s/CkFP2zVF5ylPhzPRikWLUIIPe3wXUoWvcGLGXXEpS3nq13sw2e4NnBMOAhVuFKJxqg=
  email:
    secure: Tm8LFa8DSx4muV4B++glNeCsrKSxfwXARLLz1PH57G/OKIOQDtFPxWlbzyBbeWj0CEVQlhWSilhc7oavzKcpe0bTZr4i2z7C3uc8Vb6W/MSPYtjDV7herc2GpGaXBsjvvHqK7erbxemo5yksAb79h/bhs/DR4yhcRrtglPhssD5gPSZOeV0nC1Rwx12eUzeRsxBvdNAiGA/W6H5DxdblFSMKfWYwbhiC8LyWh20c5IK0H1ztgoIZNBdTfmLks/bkWOjVG9p2kDSvs6JaNZc9ymERnt1FFt9Is0SuhmxIkfXT1ChLaittD/u/3l9zh3YUtB4Y6ZkLlB2TFQoLZrz0DWCUzuPbjSd0gwmtqLe8pVzWyipUG5C3lv4FbSeJw3lPRzvPbWLxWhmixrV/TThJQk06VfEkxo5jquf5gosw8+Myh/zWIf9e5qsffFmkvEwF6RjhQGa0D6sD0jSBgyzXpPrVNuw0M9aRh9BhtoPCUOiPD5MsNHHwUb0DLkJB5Fg9pLqzu0t26D5w1ircgjvbv3GxWjQXRHCONOwSi8lZI2Tkv/mBljHnODmK1kqVHyZOSWDY9stAakI6M7wR9npBbjg/AIuDjJNN0VuOPrc17xupWCsyz21PMuFnBGdf1o2DKDpjbj5i14KCospnV3tus4U6lymFzmmvd+qG1azuzE8=
